function $(id){ return document.getElementById(id) }
ajax={};ajax.x=function(){try{return new ActiveXObject('Msxml2.XMLHTTP')}catch(e){try{return new ActiveXObject('Microsoft.XMLHTTP')}catch(e){return new XMLHttpRequest()}}};
ajax.send=function(u,f,m,a){var x=ajax.x();x.open(m,u,true);x.onreadystatechange=function(){if(x.readyState==4)f(x.responseText)};if(m=='POST')x.setRequestHeader('Content-type','application/x-www-form-urlencoded');x.send(a)};ajax.get=function(url,func){ajax.send(url,func,'GET')};
function translatebox(){ if($("pkgdesc").getElementsByTagName("input").length==0){ $("pkgdesc").innerHTML='<input type="text" value="'+$("pkgdesc").innerHTML+'" size=50 id="translate"> <input type="button" value="翻訳" onclick="translateend();">' } }
function translateend(){ ajax.get("https://www.archlinuxjp.org/packages/translate.php?name="+$("pkgdetails").getElementsByTagName("h2")[0].innerHTML.split(" ")[0]+"&arch="+$("pkginfo").getElementsByTagName("a")[0].innerHTML+"&repo="+$("pkginfo").getElementsByTagName("a")[1].innerHTML+"&txt="+encodeURIComponent($("translate").value),function(txt){$("pkgdesc").innerHTML=txt});$("pkgdesc").innerHTML="翻訳を送信中..." }
window.onload=function(){ $("actionlist").getElementsByTagName("ul")[0].innerHTML+='<li><a href="javascript:translatebox();" title="説明文を翻訳する">パッケージの説明を翻訳</a></li>';$("filelink").onclick=function(){arch=$("pkginfo").getElementsByTagName("a")[0].innerHTML.toLowerCase();if(arch=="any"){arch="x86_64"}$("filelink").parentNode.innerHTML="リストをロード中...";ajax.get("https://www.archlinuxjp.org/packages/db/past/"+$("pkginfo").getElementsByTagName("a")[1].innerHTML.toLowerCase()+"/"+arch+"/"+$("pkgdetails").getElementsByTagName("h2")[0].innerHTML.split(" ").join("-")+"/files",function(txt){list="<ul>";file=txt.split("\n");for(i=1;i<file.length;i++){if(file[i]!=""){if(file[i].slice(-1)=="/"){list+='<li class="d">'+file[i]+'</li>'}else{list+='<li class="f">'+file[i]+'</li>'}}}list+="</ul>";$("pkgfilelist").innerHTML=list});return false} };